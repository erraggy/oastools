swagger: "2.0"
info:
  title: Medium Test API
  version: 1.0.0
  description: API with moderate complexity for benchmarking
  contact:
    name: API Support
    email: support@example.com
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html
host: api.example.com
basePath: /v1
schemes:
  - https
consumes:
  - application/json
produces:
  - application/json
tags:
  - name: users
    description: User management
  - name: posts
    description: Post management
  - name: comments
    description: Comment management
paths:
  /users:
    get:
      operationId: listUsers
      summary: List all users
      tags:
        - users
      parameters:
        - name: limit
          in: query
          type: integer
          default: 20
        - name: offset
          in: query
          type: integer
          default: 0
        - name: sort
          in: query
          type: string
          enum: [name, created, updated]
      responses:
        '200':
          description: Success
          schema:
            type: object
            properties:
              data:
                type: array
                items:
                  $ref: '#/definitions/User'
              total:
                type: integer
              limit:
                type: integer
              offset:
                type: integer
    post:
      operationId: createUser
      summary: Create a user
      tags:
        - users
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/UserCreate'
      responses:
        '201':
          description: Created
          schema:
            $ref: '#/definitions/User'
        '400':
          $ref: '#/responses/BadRequest'
  /users/{userId}:
    parameters:
      - $ref: '#/parameters/UserId'
    get:
      operationId: getUser
      summary: Get user by ID
      tags:
        - users
      responses:
        '200':
          description: Success
          schema:
            $ref: '#/definitions/User'
        '404':
          $ref: '#/responses/NotFound'
    put:
      operationId: updateUser
      summary: Update user
      tags:
        - users
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/UserUpdate'
      responses:
        '200':
          description: Success
          schema:
            $ref: '#/definitions/User'
        '404':
          $ref: '#/responses/NotFound'
    delete:
      operationId: deleteUser
      summary: Delete user
      tags:
        - users
      responses:
        '204':
          description: No content
        '404':
          $ref: '#/responses/NotFound'
  /posts:
    get:
      operationId: listPosts
      summary: List all posts
      tags:
        - posts
      parameters:
        - name: limit
          in: query
          type: integer
          default: 20
        - name: offset
          in: query
          type: integer
          default: 0
        - name: authorId
          in: query
          type: string
      responses:
        '200':
          description: Success
          schema:
            type: object
            properties:
              data:
                type: array
                items:
                  $ref: '#/definitions/Post'
              total:
                type: integer
    post:
      operationId: createPost
      summary: Create a post
      tags:
        - posts
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/PostCreate'
      responses:
        '201':
          description: Created
          schema:
            $ref: '#/definitions/Post'
        '400':
          $ref: '#/responses/BadRequest'
  /posts/{postId}:
    parameters:
      - name: postId
        in: path
        required: true
        type: string
    get:
      operationId: getPost
      summary: Get post by ID
      tags:
        - posts
      responses:
        '200':
          description: Success
          schema:
            $ref: '#/definitions/Post'
        '404':
          $ref: '#/responses/NotFound'
    put:
      operationId: updatePost
      summary: Update post
      tags:
        - posts
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/PostUpdate'
      responses:
        '200':
          description: Success
          schema:
            $ref: '#/definitions/Post'
        '404':
          $ref: '#/responses/NotFound'
    delete:
      operationId: deletePost
      summary: Delete post
      tags:
        - posts
      responses:
        '204':
          description: No content
        '404':
          $ref: '#/responses/NotFound'
  /posts/{postId}/comments:
    parameters:
      - name: postId
        in: path
        required: true
        type: string
    get:
      operationId: listPostComments
      summary: List comments for a post
      tags:
        - comments
      parameters:
        - name: limit
          in: query
          type: integer
          default: 20
        - name: offset
          in: query
          type: integer
          default: 0
      responses:
        '200':
          description: Success
          schema:
            type: object
            properties:
              data:
                type: array
                items:
                  $ref: '#/definitions/Comment'
              total:
                type: integer
    post:
      operationId: createComment
      summary: Create a comment on a post
      tags:
        - comments
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/CommentCreate'
      responses:
        '201':
          description: Created
          schema:
            $ref: '#/definitions/Comment'
        '400':
          $ref: '#/responses/BadRequest'
        '404':
          $ref: '#/responses/NotFound'
  /comments/{commentId}:
    parameters:
      - name: commentId
        in: path
        required: true
        type: string
    get:
      operationId: getComment
      summary: Get comment by ID
      tags:
        - comments
      responses:
        '200':
          description: Success
          schema:
            $ref: '#/definitions/Comment'
        '404':
          $ref: '#/responses/NotFound'
    put:
      operationId: updateComment
      summary: Update comment
      tags:
        - comments
      parameters:
        - name: body
          in: body
          required: true
          schema:
            $ref: '#/definitions/CommentUpdate'
      responses:
        '200':
          description: Success
          schema:
            $ref: '#/definitions/Comment'
        '404':
          $ref: '#/responses/NotFound'
    delete:
      operationId: deleteComment
      summary: Delete comment
      tags:
        - comments
      responses:
        '204':
          description: No content
        '404':
          $ref: '#/responses/NotFound'
parameters:
  UserId:
    name: userId
    in: path
    required: true
    type: string
    description: User identifier
definitions:
  User:
    type: object
    required:
      - id
      - username
      - email
    properties:
      id:
        type: string
        description: User identifier
      username:
        type: string
        minLength: 3
        maxLength: 50
      email:
        type: string
        format: email
      firstName:
        type: string
      lastName:
        type: string
      avatar:
        type: string
        format: uri
      bio:
        type: string
        maxLength: 500
      createdAt:
        type: string
        format: date-time
      updatedAt:
        type: string
        format: date-time
  UserCreate:
    type: object
    required:
      - username
      - email
      - password
    properties:
      username:
        type: string
        minLength: 3
        maxLength: 50
      email:
        type: string
        format: email
      password:
        type: string
        minLength: 8
      firstName:
        type: string
      lastName:
        type: string
  UserUpdate:
    type: object
    properties:
      username:
        type: string
        minLength: 3
        maxLength: 50
      email:
        type: string
        format: email
      firstName:
        type: string
      lastName:
        type: string
      avatar:
        type: string
        format: uri
      bio:
        type: string
        maxLength: 500
  Post:
    type: object
    required:
      - id
      - authorId
      - title
      - content
    properties:
      id:
        type: string
      authorId:
        type: string
      title:
        type: string
        minLength: 1
        maxLength: 200
      content:
        type: string
      excerpt:
        type: string
        maxLength: 500
      tags:
        type: array
        items:
          type: string
      published:
        type: boolean
        default: false
      publishedAt:
        type: string
        format: date-time
      createdAt:
        type: string
        format: date-time
      updatedAt:
        type: string
        format: date-time
  PostCreate:
    type: object
    required:
      - title
      - content
    properties:
      title:
        type: string
        minLength: 1
        maxLength: 200
      content:
        type: string
      excerpt:
        type: string
        maxLength: 500
      tags:
        type: array
        items:
          type: string
      published:
        type: boolean
        default: false
  PostUpdate:
    type: object
    properties:
      title:
        type: string
        minLength: 1
        maxLength: 200
      content:
        type: string
      excerpt:
        type: string
        maxLength: 500
      tags:
        type: array
        items:
          type: string
      published:
        type: boolean
  Comment:
    type: object
    required:
      - id
      - postId
      - authorId
      - content
    properties:
      id:
        type: string
      postId:
        type: string
      authorId:
        type: string
      content:
        type: string
        minLength: 1
        maxLength: 1000
      createdAt:
        type: string
        format: date-time
      updatedAt:
        type: string
        format: date-time
  CommentCreate:
    type: object
    required:
      - content
    properties:
      content:
        type: string
        minLength: 1
        maxLength: 1000
  CommentUpdate:
    type: object
    properties:
      content:
        type: string
        minLength: 1
        maxLength: 1000
  Error:
    type: object
    required:
      - code
      - message
    properties:
      code:
        type: string
      message:
        type: string
      details:
        type: object
responses:
  BadRequest:
    description: Bad request
    schema:
      $ref: '#/definitions/Error'
  NotFound:
    description: Resource not found
    schema:
      $ref: '#/definitions/Error'
